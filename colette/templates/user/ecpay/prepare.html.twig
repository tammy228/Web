{% extends 'base.html.twig' %}
{% block body %}
    <script>
        $(function() {
            $('.step_next_btn').click(function() {
                var index = $(this).closest('.shop_step').index();
                $('.stepDot li').eq(index - 1).addClass('alredy');
                $('.stepDot li').eq(index).addClass('active');
                $('.shop_step').eq(index).addClass('active').siblings().removeClass('active');
            });
            $('.comeBack_shopCart_btn').click(function() {
                var index = $(this).closest('.shop_step').index();
                $('.stepDot li').eq(index - 2).removeClass('alredy');
                $('.stepDot li').eq(index - 1).removeClass('active');
                $('.shop_step').eq(index - 2).addClass('active').siblings().removeClass('active');
            });
        })


    </script>
    <main class="cart activePage active" id="cart">
    <div class="step_dot">
        <ul class="stepDot">
            <li class="active alredy">
                <div class="check"></div>
            </li>
            <li>
                <p>2</p>
                <div class="check"></div>
            </li>
            <li>
                <p>3</p>
            </li>
        </ul>
    </div>
    <form id="form3" method="post" action="{{url('ECPay')}}">
        <div class="shop_step shop_step2 active">
        <ul>
            <li>
                <h4>收件人資訊</h4>
            </li>
{#            <li id="purchase_information" class="information information_purchase">#}
{#                <h5>購買人資訊</h5>#}
{#                    <ol>#}
{#                        <li class="name">#}
{#                            <p>姓名</p>#}
{#                            <input type="text">#}
{#                        </li>#}
{#                        <li class="phone">#}
{#                            <p>電話號碼</p>#}
{#                            <input type="tel">#}
{#                        </li>#}
{#                        <li class="email">#}
{#                            <p>EMAIL</p>#}
{#                            <input type="mail">#}
{#                        </li>#}
{#                        <div id="purchase_information_twzipcode">#}
{#                            <div data-role="county" data-name="county" class="county">#}
{#                                <p>城市</p>#}
{#                            </div>#}
{#                            <div data-role="district" data-name="township" class="township">#}
{#                                <p>鄉鎮市區</p>#}
{#                            </div>#}
{#                            <div data-role="zipcode" data-name="postalCode" class="postalCode">#}
{#                                <p>郵遞區號</p>#}
{#                            </div>#}
{#                        </div>#}
{#                        <li class="add">#}
{#                            <p>詳細地址</p>#}
{#                            <input type="text">#}
{#                        </li>#}
{#                        <li class="newpassword">#}
{#                            <p>NEW PASSWORD</p>#}
{#                            <input type="text">#}
{#                        </li>#}
{#                        <li class="confirm_newpassword">#}
{#                            <p>CONFIRM NEW PASSWORD</p>#}
{#                            <input type="text">#}
{#                        </li>#}
{#                    </ol>#}
{#            </li>#}
            <li id="information_recipient" class="information information_recipient">
                <h5>收件人資訊</h5>
{#                <div class="smae_purchaser">#}
{#                    <input id="same_people" type="checkbox">#}
{#                    <label for="same_people">同購買人</label>#}
{#                </div>#}
                <ol>
                    <li class="name">
                        <p>姓名</p>
                        <input name="name" type="text" required>
                    </li>
                    <li class="phone">
                        <p>電話號碼</p>
                        <input name="mobile" type="tel" id="mobile" required onchange="checkMobile()">
                        <div id="mobile-helper" style="color: red"></div>
                    </li>
                    <li class="email">
                        <p>EMAIL</p>
                        <input name="email" type="email" id="email" required onchange="checkEmail()">
                        <div id="email-helper2"  style="color: red"></div>
                    </li>
                    <div id="information_recipient_twzipcode">
                        <div data-role="county" data-name="county" class="county">
                            <p>城市</p>
                        </div>
                        <div data-role="district" data-name="district" class="township">
                            <p>鄉鎮市區</p>
                        </div>
                        <div data-role="zipcode" data-name="postalCode" class="postalCode">
                            <p>郵遞區號</p>
                        </div>
                    </div>
                    <li class="add">
                        <p>詳細地址</p>
                        <input name="street" type="text" required>
                    </li>

{#                    <li class="newpassword">#}
{#                        <p>NEW PASSWORD</p>#}
{#                        <input type="text">#}
{#                    </li>#}
{#                    <li class="confirm_newpassword">#}
{#                        <p>CONFIRM NEW PASSWORD</p>#}
{#                        <input type="text">#}
{#                    </li>#}
                </ol>
            </li>
            <li class="payment">
                <h4>付款方式</h4>
                <div class="payment-method">
                    <div class="method method-atm">
                        <div class="checkbox">
                            <input type="radio" id="checkbox-atm" name="ChoosePayment" value="Credit" checked>
                        </div>
                        <label for="checkbox-atm">信用卡</label>
                    </div>
                    <div class="method method-crediCard">
                        <div class="checkbox">
                            <input type="radio" id="checkbox-crediCard" name="ChoosePayment" value="WebATM">
                        </div>
                        <label for="checkbox-crediCard">網路ATM</label>
                    </div>
                </div>
            </li>
            <li class="payment">
                <h4>送貨時段</h4>
                <div class="payment-method">
                    <div class="method method-atm">
                        <div class="checkbox">
                            <input value="morning" type="radio" id="" name="delivery" >
                        </div>
                        <label for="">上午</label>
                    </div>
                    <div class="method method-crediCard">
                        <div class="checkbox">
                            <input value="afternoon" type="radio" id="" name="delivery">
                        </div>
                        <label for="">下午</label>
                    </div>
                    <div class="method method-crediCard">
                        <div class="checkbox">
                            <input  value="allDay" type="radio" id="" name="delivery" checked>
                        </div>
                        <label for="">整天</label>
                    </div>
                </div>
            </li>
            <li class="payment">
                <h4>備註</h4>
                <textarea name="remark" cols="50" rows="5"></textarea>
            </li>
            <li class="tip1">
                <a href="{{ path("cart.list") }}">
                <div class="button comeBack_shopCart_btn">回購物車</div>
                </a>
                <button type="submit" class="button step_next_btn active">完成訂購</button>
                <!--下一步要購物條件符合才會加入active-->
            </li>
        </ul>
    </div>
    </form>
</main>
{% endblock %}

{% block javascripts %}
    <script>
        $("#purchase_information_twzipcode").twzipcode();
        $("#information_recipient_twzipcode").twzipcode();

        function checkMobile() {
            var x = document.getElementById("mobile").value;

            if (x.match(/^09[0-9]{2}-[0-9]{3}-[0-9]{3}$/)) {
                document.getElementById("mobile-helper").innerHTML = "";    // 09xx-xxx-xxx
            } else if(x.match(/^09[0-9]{2}-[0-9]{6}$/)) {
                document.getElementById("mobile-helper").innerHTML = "";    // 09xx-xxxxxx
            } else if(x.match(/^09[0-9]{8}$/)) {
                document.getElementById("mobile-helper").innerHTML = "";   // 09xxxxxxxx
            } else {
                document.getElementById("mobile-helper").innerHTML = "手機錯誤";
            }
        }

        function checkEmail() {
            var emailPat = /^(([^<>()\[\]\\.,;:\s@\"\”]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@(([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})|(\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([^\-][a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            var x = document.getElementById("email");
            if(x.match(emailPat)){
                document.getElementById("email-helper2").innerHTML = "";
            }
            else {
                document.getElementById("email-helper2").innerHTML = "信箱錯誤";
            }
        }

    </script>
{% endblock %}